import frappe
from vote.utils.mtrhsps import send_payload2, mtrhsps

def sendbypf():
	payload = send_payload2()
	# pfs = ["3659","7301","3084","8293","8299"]
	# pfs =["8299","8291","7278","6021","3926","2660","3027" "6225","4812","7606","6314","6389","7717","7675","8307","6603","2877","6443","6008","3765","7465"]
	# pfs=["6877","7242"]
	# pfs =['4965','7309','4228','7645','5276','2680','7301','3659','7645','4228','3659','7309','3706','4758','3492','8244','6849','6249','4457','3686','3814','6648','2782','3806','4664','7467','8297','8301','8302','8296','8298','6206','6813','6015','3172','7466']
	# pfs=['6977','7158']
	# pfs =['6361','4133','3307','3023','3442','2853','3365','7029','2680','3814','8299','3083','4241','7301','2680','5276','3442','7754','7573','7139','8250','2389','7740','3047','6324','6983','4702','2389','7481','4251','6877','6813']
	# pfs =['2689','2689','4015','4532']
	# pfs =['3492','6586','8244','6849','8273','7596','4083','7277','7593']
	# pfs=["3467","6977","8046","7131","6010","2982","7713"]
	# pfs=["2757","6033","4292","7650","8309","8310","6084","2454","2498","3389"]
	# pfs =["2757","7145","4580","6122","6682","6736","4645"]
	# pfs= ["4596","8299","2888"]
	# pfs= ["6511","3196"]
	# pfs=["7618","4160","6511","6896","4156","7328"]
	# pfs =["6765","6603","8096"]
	# pfs =["6129","6634","6666","7619","6619","6634","8294","8292","8291","6638","7731","8094"]
	# pfs=["6677","7087","6627","7185","7315","3102"]
	# pfs=["2306","6468","3957","2888","7643","4806","4693","2608"]
	# pfs=["6754","7731","6601","2750","4083","4708"]
	# pfs=["6012","3216","7630","7903","6204","2783","3609","3665","4011"]
	# pfs =["4696","3011"]
	# pfs =["2680","3428","3915","6590","7068","6233","6014"]
	pfs=["6324","3091","4866"]
	msg ="Dear Member, Your Voter ID is {}.\nTo vote for your candidate, click on the link https://vote.mtrhsps.co.ke and follow the prompts.\nIn case of difficulty,visit the voting centre at Memorial Grounds for assistance.\nVoting starts at 8AM and ends at 4PM sharp."
	for pf in pfs:
		voter_id = list(filter(lambda x: x.get("Member ID")==pf, payload))#frappe.get_value("Institution Member", dict(member_id=pf),['name','cell_number'], as_dict=1)
		if not voter_id:
			print("Not found {}".format(pf))
			continue
		mtrhsps(voter_id[0].get("Cell Number"), msg.format(voter_id[0].get("ID")))