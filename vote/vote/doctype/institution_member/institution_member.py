# -*- coding: utf-8 -*-
# Copyright (c) 2020, team_paperless and contributors
# For license information, please see license.txt

from __future__ import unicode_literals
import frappe
from frappe.model.document import Document
from frappe.core.doctype.user_permission.user_permission import clear_user_permissions
from frappe.core.doctype.sms_settings.sms_settings import send_sms
from frappe.utils.background_jobs import enqueue
from frappe import _
from vote.utils.election_details import stage_otp
from vote import sendmail


template = """
	<div>
	<p><b>Dear {} </b></p> 
	<p>You have been registered to participate in the KMPDU elections 2021. </p>
	<p><b>VOTER ID:</b> {} </p>
	<p>Use the Voter ID and your National ID to log into the portal provided below to verify or edit your details.</p>
	<p><b>URL:</b> https://kmpdu.bizpok.com </p>
	<br/>
	<b>KMPDU IEC</b>
	</div>
"""
sms_template = """
	Dear {} , You have been registered to participate in the KMPDU elections 2021. 
	VOTER ID: {}
	Use the Voter ID and your National ID to log into the portal provided below to verify or edit your details.
	URL: kmpdu.bizpok.com
"""
universal_sms_template = """
	Dear {} , You have been registered to participate in the {}. VOTER ID: {}
	Use the Voter ID and your PF Number to log into the portal provided below to verify or edit your details.
	URL: nnak.bizpok.com
"""


class InstitutionMember(Document):
    def before_save(self):
        self = self.capitalize_essential_fields()
        self.validate_member_id()
        surname = self.surname
        other_names = self.other_names
        self.full_name = f"{surname}, {other_names}"
        self.generate_voter_domains()
        if not self.member_id:
            self.member_id = self.name
        return

    def capitalize_essential_fields(self):
        if self.surname:
            self.set('surname', str(self.surname).upper().strip())
        if self.other_names:
            self.set('other_names', str(self.other_names).upper().strip())
        if self.electoral_district:
            self.set('electoral_district', str(
                self.electoral_district).upper().strip())
        if self.email_address:
            self.set('email_address', str(self.email_address).lower().strip())
        return self

    def validate_member_id(self):
        duplicate = frappe.db.get_value("Institution Member",
                                        {"member_id": self.member_id, "institution": self.institution, "name": ["!=", self.name]}, "full_name")
        if duplicate:
            member_id = self.member_id
            frappe.throw(
                f"""Sorry, Member ID {member_id} is already taken by another member: {duplicate}""")

    def generate_voter_domains(self):
        electoral_district = self.electoral_district
        frappe.msgprint(f"Generating active domains for {electoral_district}")
        applicable_domains = self.member_applicable_domains(electoral_district)
        self.set("applicable_voter_districts", [])
        for j in applicable_domains:
            row = self.append('applicable_voter_districts', {})
            row.electoral_district = j
        frappe.msgprint(f"Applicable Domains {applicable_domains}")

    def member_applicable_domains(self, electoral_district):
        domain = electoral_district
        applicable_domains = []
        proceed = True
        while proceed:
            if frappe.get_value("Electoral District", domain, "parent_electoral_district"):
                applicable_domains.append(domain)
                domain = frappe.get_value(
                    "Electoral District", domain, 'parent_electoral_district')
            else:
                applicable_domains.append(domain)
                proceed = False
        return applicable_domains

    def apply_permissions(self):
        userid = self.create_user
        self.set("user_id", userid)
        return
        # clear_user_permissions(userid,"Institution")
        # frappe.get_doc()
        institution = self.institution
        fullname = self.get("full_name")
        # if institution:
        '''
		if userid:
			frappe.get_doc(dict(
					doctype='User Permission',
					user=userid,
					allow="Institution",
					for_value=institution,
					apply_to_all_doctypes=1
			))
		frappe.msgprint("User {0} - {1} has been assigned to {2}".format(userid, fullname, institution))
		#self.flags.ignore_user_permissions=True
		self.save()'''

    def create_application_user(self, preferred_role_profile=None):
        existing_user = frappe.get_all("User", filters=dict(
            email=self.email_address), fields=["*"])
        if existing_user:
            if existing_user[0].get("role_profile_name") == 'KMPDU Audit':
                return
            doc = frappe.get_doc("User", self.email_address)
            doc.db_set("role_profile_name", preferred_role_profile)
            # doc.save(ignore_permissions = True)
            return
        position = self.current_position

        position_settings = frappe.db.get_value("Institution Position", position,
                                                ["requires_application_user_account", "is_elective"], as_dict=True)
        # frappe.throw(f"{position_settings.requires_application_user_account}")
        if self.member_status != "Active":
            frappe.throw(
                "Inactive members cannot have a user account. Please check Member Status")
            return
        if not position_settings.requires_application_user_account:
            frappe.throw(
                f"{position} not permitted to have a user account. Please update Institution Position")
            return
        role_profile = preferred_role_profile or "Institution Manager"
        frappe.flags.in_import = True
        user = frappe.get_doc({
            'doctype': 'User',
            'send_welcome_email': 0,
            'email': self.email_address,
            'first_name': self.full_name,
            'role_profile_name': role_profile,
            'user_type': 'System User'
            # 'redirect_url': link
        })
        user.insert()
        frappe.msgprint(f"{user}")
        return user

    def send_voter_card(self, election=None):
        from vote.utils.mtrhsps import mtrhsps

        if not election:
            return  # has to be the election document

        voter_id = self.get("name")

        doc = self

        telephone, email = doc.get("cell_number"), doc.get("email_address")

        # message =  self.get_voter_registration_message(election=election)
        # sms_msg = sms_template.format(self.get("full_name"), self.get("name"))

        sms_msg = universal_sms_template.format(
            self.get("full_name"), election, self.get("name"))

        if telephone:
            if frappe.get_value("Institution Member", voter_id, 'institution') == "MTRH Staff Pension Scheme":
                mtrhsps(telephone, sms_msg)
            else:
                send_sms([telephone], sms_msg)

        self.db_set("alerted", True)
        print(" Set as alerted")

        # email_message =f"<h3></h3><h6>{message}</h6>"
        email_message = template.format(self.full_name, voter_id)
        # email_args =dict(
        # 	recipients = [email],
        #     message = _(email_message),
        # 	subject = _("Voter Registration ID")
        # )
        # if email: enqueue(method=vote.sendmail, queue='long', timeout=300, **email_args)
        # if email: sendmail(recipients=[email], message=_(email_message), subject=_("Voter Registration ID"))
        return

    def get_voter_registration_message(self, election=None):
        if not election:
            return
        election_type = 'Mock' if election.is_mock_elections else ''
        institution = election.get("institution")
        starts_from = election.get("election_start")
        ends = election.get("election_ends")
        voter_id = self.get("name")
        voter_name = self.get("full_name")

        link1, link2 = "https://kmpdu.bizpok.com/", "https://vote-ui.netlify.app/#/"
        links_text = f"{link1} or {link2}"
        # otp = stage_otp(self.get("name"), instant_otp = 0)
        # details =f"Voter ID: {voter_id}\nElection Starts:{starts_from}\nElection Ends: {ends}\n\nPlease use {links_text} to access the system."
        details = f"Voter ID: {voter_id}\nLink: {links_text}."

        return f"KMPDU Elections Voter Instruction:\n{details}"

        '''return f"Dear {voter_name} your\
			 voting details for the upcoming {election_type} Elections in {institution}\
				 have been generated as below\n\n{details}\n\n"'''

def disable_voter_register():
	payload = list(dict.fromkeys(get_mtrhsps()))
	to_disable = [x.get("name") for x in frappe.get_all("Institution Member", filters=dict(electoral_district='MTRHSPS STATION',member_id=["IN",payload]), fields =["name"])].append("80000000")

	query_cond1 ="WHERE name in {}".format(tuple(to_disable))
	query_cond2 ="WHERE system_id in {} and parent = 'V-REG-12234' ".format(tuple(to_disable)) 

	frappe.db.sql("DELETE FROM `tabInstitution Member` {}".format(query_cond1))
	frappe.db.sql("DELETE FROM `tabVoter Register Member` {}".format(query_cond2))



		 
def get_mtrhsps():
    return ["4362", "4861", "7554", "2610", "2688", "4760", "6462", "6365", "4126", "5274", "7332", "6488", "3016", "4388", "3338", "4285", "6463", "6561", "6459", "3640", "3916", "3264", "7448", "2732", "4067", "3474", "3974", "6890", "4704", "3981", "3977", "7474", "4910", "4941", "6619", "3966", "4660", "6041", "3920", "6747", "4374", "4375", "3442", "4670", "4938", "3635", "6219", "7352", "4021", "2280", "6309", "6349", "6398", "4168", "6378", "3461", "6604", "3075", "6813", "4254", "7589", "6317", "3581", "4442", "4499", "6407", "6642", "3361", "6305", "6331", "7245", "6418", "3081", "6303", "3529", "7221", "6345", "3576", "3583", "5139", "2785", "3034", "3105", "7235", "7229", "2994", "4699", "4366", "4321", "4688", "3169", "3299", "4859", "3213", "4951", "3131", "4944", "7384", "7626", "3252", "6017", "7317", "7511", "7440", "3038", "6059", "7368", "6948", "7082", "3463", "7230", "6524", "4235", "7213", "7238", "7246", "7385", "7177", "2894", "3720", "7430", "3256", "4090", "7260", "7214", "7460", "6749", "3891", "6076", "7746", "6952", "3320", "7188", "6608", "6772", "3738", "7195", "6731", "3051", "4027", "4087", "6592", "6814", "3846", "3282", "5226", "6401", "4676", "6673", "4300", "7441", "7350", "3603", "3663", "3852", "3942", "3854", "4101", "3956", "4327", "3416", "3650", "7422", "7510", "2678", "2624", "2621", "3655", "7316", "6135", "5233", "2410", "4451", "4723", "6696", "3042", "2788", "3061", "2632", "7365", "4955", "4195", "4344", "3308", "4322", "2247", "4675", "4959", "3504", "3247", "6480", "6650", "4035", "6598", "6964", "7482", "7341", "6496", "3470", "7876", "7904", "2916", "6625", "3836", "6278", "6457", "7709", "7790", "7076", "7010", "4289", "6692", "4901", "7905", "7809", "7012", "6400", "7559", "7900", "3593", "4009", "3211", "6705", "2225", "7983", "7988", "3261", "7891", "6255", "6559", "6171", "6801", "7896", "7990", "2907", "8152", "7883", "7895", "6763", "6968", "6827", "6885", "6032", "7323", "4598", "4239", "6656", "7670", "4841", "4286", "6039", "7903", "6253", "7092", "7013", "7771", "7014", "2911", "6981", "7443", "6961", "7019", "6044", "7894", "4971", "7105", "6691", "6999", "7906", "7875", "6984", "7537", "4981", "2411", "7093", "6452", "4169", "7364", "7770", "2335", "7899", "4608", "3659", "3821", "4641", "7118", "4973", "7007", "7120", "7075", "4659", "7116", "6487", "4651", "4055", "2401", "7893", "2992", "7004", "4781", "6460", "4335", "6126", "3502", "6794", "3818", "4602", "7002", "4744", "6844", "3531", "4363", "7000", "7922", "3557", "7789", "7632", "4639", "7077", "6170", "4612", "7008", "6779", "2908", "6145", "2492", "2242", "3587", "7071", "4970", "2551", "6993", "7750", "6162", "7099", "4840", "3386", "4987", "7094", "6239", "2493", "7914", "7749", "7302", "6979", "7887", "4036", "7912", "4367", "6558", "6010", "6383", "3221", "6987", "4301", "7886", "7016", "7898", "4835", "2366", "4583", "7015", "3998", "6790", "3771", "6990", "7910", "2898", "7113", "7897", "2400", "6653", "7888", "6806", "6839", "7913", "4288", "3874", "4092", "3060", "6046", "6036", "6998", "3786", "4371", "6988", "2286", "2374", "3398", "4611", "7908", "7892", "7078", "7491", "7112", "3872", "3890", "7901", "6989", "4726", "7022", "6645", "6838", "7926", "2464", "6986", "3707", "2093", "6997", "6982", "4860", "7946", "4979", "4051", "4379", "6787", "4921", "7115", "3788", "4364", "4962", "7599", "4287", "3604", "4847", "4652", "6338", "7552", "7018", "3763", "2365", "6816", "2913", "6915", "7333", "6644", "7928", "2472", "4899", "7902", "7114", "4968", "6635", "7885", "7083", "4554", "7066", "4834", "2511", "3223", "3677", "7889", "7020", "2316", "3711", "7884", "6479", "4183", "2406", "4904", "7772", "2587", "7880", "6985", "6502", "2498", "4131", "3207", "3876", "3309", "3822", "3667", "3149", "7890", "7923", "7810", "2454", "7996", "7236", "6953", "6996", "7312", "7255", "6458", "6102", "7338", "6206", "7551", "6183", "7327", "7168", "7596", "6188", "7495", "7311", "7865", "4227", "7794", "7656", "3036", "7823", "4714", "2701", "6361", "7576", "6648", "6768", "6927", "2627", "3999", "6408", "6942", "4565", "7655", "6212", "4049", "4350", "7752", "7751", "7642", "7710", "7650", "3628", "7647", "3705", "6279", "3779", "7769", "6517", "3020", "4837", "4762", "6323", "3136", "3391", "6270", "2432", "3178", "6111", "4884", "2293", "4683", "6215", "6030", "4663", "3022", "4474", "2686", "7768", "4669", "3133", "6040", "2429", "4916", "4850", "6840", "2417", "2327", "4824", "2381", "7947", "6205", "4450", "6533", "6681", "7565", "7601", "7814", "7866", "7587", "7107", "7296", "7349", "6970", "7109", "6957", "6695", "6818", "6453", "6471", "6589", "3183", "3312", "4084", "6055", "7088", "6638", "7753", "2941", "7104", "2758", "2681", "6992", "6878", "2711", "2715", "2666", "2690", "6353", "2612", "4521", "3719", "2210", "4801", "4567", "4426", "7490", "4413", "7757", "7180", "7538", "7622", "4568", "4815", "7106", "7086", "7103", "4352", "6689", "6043", "7487", "7293", "6758", "7556", "3065", "7098", "7570", "7111", "7489", "7691", "6066", "7457", "7329", "4790", "7089", "7110", "4896", "6679", "4956", "3001", "7486", "6450", "6766", "6652", "6508", "6578", "6101", "6254", "6092", "6071", "6116", "5256", "5014", "6295", "4564", "7699", "2599", "6682", "6627", "2658", "6193", "7595", "6461", "7473", "6115", "7453", "7342", "2679", "6268", "4936", "7488", "7693", "7585", "7602", "7485", "7708", "7600", "7344", "7307", "7090", "6640", "6588", "6503", "6550", "7100", "6297", "7747", "6007", "6192", "6246", "3894", "6069", "5275", "6029", "3607", "6980", "4636", "4146", "3951", "4098", "3534", "7666", "4664", "2574", "4089", "3838", "3671", "6446", "3539", "7638", "3464", "3406", "6535", "7767", "4114", "4115", "3979", "4228", "6376", "4282", "2667", "4206", "7140", "6266", "6228", "6347", "6235", "6064", "7271", "6034", "6756", "4759", "4957", "3601", "4133", "3849", "4137", "2635", "3910", "3407", "3527", "6593", "7478", "3819", "6411", "4135", "7161", "7169", "6455", "3140", "4846", "6519", "6506", "3070", "3744", "6733", "2568", "2682", "6670", "6569", "3820", "6572", "7581", "6655", "3068", "2849", "2984", "4546", "3050", "3023", "4797", "3372", "4838", "3460", "6392", "3177", "6113", "6257", "3026", "2853", "2857", "7273", "2866", "7291", "4232", "3238", "3609", "2217", "4277", "3570", "4459", "6895", "6529", "6439", "6896", "4094", "6703", "7618", "2983", "7334", "3171", "4241", "3300", "2760", "2776", "2691", "2744", "2717", "2383", "2642", "2653", "2606", "2428", "2608", "2607", "3453", "2431", "4479", "2420", "3661", "3268", "2284", "2273", "3243", "4687", "3272", "3168", "3186", "3332", "3147", "4167", "6467", "6094", "6736", "3269", "2988", "3115", "2985", "6663", "6306", "7643", "3273", "3006", "3187", "3933", "6417", "3586", "6710", "6590", "6465", "6798", "3524", "6728", "6676", "3447", "6702", "6950", "7160", "6929", "7623", "4143", "6180", "4245", "7281", "7253", "7108", "3542", "7629", "7701", "7244", "7454", "7263", "7620", "6186", "6204", "6143", "7707", "7639", "4892", "7467", "4843", "2887", "3365", "6187", "7608", "7815", "3106", "3915", "4693", "4577", "6797", "4099", "3888", "3154", "3083", "3313", "3118", "3608", "7189", "4011", "3349", "3497", "7578", "3468", "7285", "7248", "6943", "3297", "6603", "3957", "3626", "3548", "3806", "3121", "3827", "3128", "4124", "4478", "3949", "3724", "6960", "3907", "3627", "3142", "4041", "4141", "6003", "3137", "4173", "4005", "4435", "3937", "3990", "4148", "6155", "3122", "3082", "4948", "4338", "6189", "6006", "4992", "4317", "7270", "4839", "6107", "6026", "2783", "4806", "2899", "4749", "4947", "6075", "3109", "7339", "7201", "3007", "2993", "3074", "7200", "2888", "4667", "2903", "2987", "3012", "3011", "6774", "4791", "3451", "7631", "7605", "4778", "7745", "5142", "2189", "7162", "6081", "3040", "4056", "7138", "4214", "4784", "3980", "6049", "6815", "7287", "3127", "7149", "2733", "7737", "6123", "7351", "7726", "6114", "3077", "2847", "3605", "7732", "7301", "7305", "2910", "6722", "6634", "7295", "4100", "3141", "3146", "7652", "6717", "6129", "3732", "7163", "6680", "4750", "3926", "7712", "6432", "6015", "3532", "3922", "7137", "6314", "2669", "2757", "3559", "6850", "6216", "7152", "4290", "7604", "3540", "4032", "3307", "3521", "3567", "6954", "7181", "3017", "6110", "4708", "7719", "4325", "3571", "3935", "7446", "2721", "7319", "2186", "7462", "3014", "7722", "7379", "6729", "2932", "3842", "6958", "7376", "6000", "7159", "7619", "4883", "2909", "4965", "7158", "3155", "4887", "6489", "6072", "4662", "4963", "2765", "6399", "6983", "3260", "3135", "4935", "6201", "7694", "7131", "3871", "7297", "7740", "6966", "3285", "6057", "7731", "6969", "7142", "7720", "4109", "4713", "2762", "7306", "7717", "2844", "6699", "7725", "7318", "7144", "4017", "3515", "7739", "7145", "6117", "4481", "4130", "3492", "6849", "7156", "4769", "2302", "6048", "3533", "3027", "7476", "7240", "7723", "4511", "3506", "2886", "4123", "7714", "3750", "3028", "7759", "6557", "4103", "6931", "7730", "7290", "6016", "7377", "4672", "3456", "4798", "5231", "7154", "4765", "7081", "7721", "7286", "4182", "7696", "6427", "4083", "4486", "6095", "7593", "4696", "7711", "6105", "7299", "3240", "2876", "7211", "4983", "3067", "7136", "3172", "6355", "7309", "7713", "7256", "7257", "6659", "6657", "2764", "7754", "2706", "7135", "3049", "3389", "4596", "3163", "6944", "7321", "3123", "2746", "7237", "3161", "3971", "3364", "7724", "7355", "3166", "4093", "3703", "6628", "2890", "2877", "7716", "4061", "2205", "7727", "3809", "7734", "4436", "3094", "2871", "6639", "4170", "4283", "3989", "3047", "7277", "7469", "4179", "3019", "2187", "4530", "6341", "2631", "7289", "2661", "7304", "4557", "4323", "3511", "6568", "4989", "4420", "7995", "6761", "7970", "6526", "6014", "4419", "4768", "2595", "3393", "6579", "6220", "7703", "6555", "2835", "3478", "4686", "4931", "4930", "6207", "7336", "6621", "4918", "2851", "2253", "3787", "2576", "2647", "7706", "6941", "7862", "7831", "7833", "7827", "7825", "2999", "2664", "7702", "2572", "7447", "3257", "4710", "7262", "4866", "6721", "6013", "7633", "6612", "2842", "7250", "6380", "4919", "6497", "6511", "3816", "6622", "6134", "6130", "6451", "2693", "6435", "4318", "4630", "4395", "4150", "7096", "4858", "7225", "4502", "6620", "7147", "2689", "2662", "6404", "3927", "4158", "3765", "2630", "6302", "4247", "6765", "6647", "7102", "4922", "7624", "3432", "4872", "4144", "7512", "4172", "3304", "6280", "4885", "6012", "4767", "3276", "7254", "3895", "6473", "4159", "7472", "7226", "2559", "6210", "6474", "3747", "6669", "3834", "4634", "3431", "2735", "4977", "4972", "6139", "3258", "6930", "4740", "2239", "2397", "2893", "7569", "3689", "2323", "6470", "4601", "4555", "2826", "4456", "3411", "3418", "2238", "3242", "3657", "3066", "2990", "3091", "3215", "3749", "2196", "2864", "4071", "3326", "4202", "4224", "2275", "2325", "4107", "4157", "2388", "3658", "4155", "2436", "2503", "4201", "2197", "3602", "2195", "3932", "4731", "4615", "4192", "4492", "2384", "2110", "2392", "4453", "4040", "3893", "4118", "4119", "4535", "4746", "4104", "4632", "4106", "6932", "4590", "4257", "4401", "3928", "4617", "4589", "4773", "4043", "3482", "7991", "3963", "6073", "2301", "4293", "4649", "2774", "4440", "4966",
            "6350", "7558", "7337", "7085", "2564", "4932", "2897", "4788", "2563", "4616", "4091", "7553", "4105", "2344", "3784", "7762", "2324", "4271", "2488", "2838", "3665", "2219", "3943", "4770", "4069", "2963", "3633", "4065", "2528", "3973", "7917", "4276", "7583", "2920", "6194", "3417", "7907", "3358", "7959", "4793", "3535", "7607", "6466", "4939", "2750", "7697", "2837", "7315", "6165", "7592", "4076", "4270", "7217", "7095", "6402", "7343", "3828", "3848", "2278", "7097", "4070", "2220", "7557", "4643", "7516", "7477", "2895", "6769", "3902", "7603", "6641", "7864", "6312", "7964", "3392", "6811", "3363", "3851", "3662", "3599", "3618", "4116", "3847", "2137", "2487", "5213", "4812", "2861", "4457", "3015", "7298", "6151", "3354", "2810", "5124", "6429", "7442", "3071", "7573", "3896", "7715", "4561", "7141", "3498", "7280", "5242", "2670", "2303", "7155", "2614", "6227", "6694", "6190", "7658", "4427", "2995", "4578", "4758", "4719", "2246", "2997", "6477", "6166", "3112", "7288", "2636", "6091", "2962", "7575", "6668", "7665", "5201", "3310", "7878", "4237", "4702", "4296", "4575", "7320", "3296", "7649", "7324", "6150", "3344", "6469", "7179", "7872", "7580", "3774", "6755", "7597", "7700", "7348", "7506", "6977", "2698", "6330", "3879", "3815", "6522", "4732", "7079", "4259", "4394", "4437", "4430", "7654", "4844", "6449", "4832", "6214", "6329", "7651", "3493", "7916", "4886", "4154", "4658", "6096", "6444", "7468", "6672", "3459", "6199", "7614", "6277", "7755", "7641", "3817", "2805", "7219", "3641", "3508", "3096", "7176", "7678", "6951", "4244", "7292", "3865", "7505", "3855", "7613", "3462", "4967", "2751", "2561", "6730", "7232", "6464", "7549", "4204", "4558", "6585", "4151", "3546", "6788", "7310", "6197", "6236", "3480", "2162", "6293", "4424", "2426", "4674", "7534", "2466", "6723", "3696", "3653", "2468", "6776", "7545", "3679", "6793", "3064", "2307", "7935", "2361", "7976", "3832", "4433", "5200", "3652", "6422", "2598", "7979", "6821", "3087", "4238", "3722", "6868", "3864", "2356", "4551", "3394", "2518", "7818", "4584", "6540", "6872", "4024", "6754", "3245", "6493", "6325", "3843", "2443", "7561", "4313", "2953", "7860", "6370", "2291", "3664", "6424", "7795", "3259", "2924", "3402", "6566", "3900", "7431", "4717", "6281", "6249", "7184", "7540", "6841", "6247", "2484", "7871", "4308", "2601", "3740", "7779", "7389", "7060", "7820", "7362", "4014", "6601", "6164", "3964", "2183", "3445", "6011", "2998", "7780", "2584", "3793", "7452", "4422", "4739", "6880", "7874", "7420", "4249", "6610", "2906", "6567", "4736", "7059", "2333", "6864", "4501", "3428", "2279", "6711", "4585", "2264", "4312", "6242", "4520", "6023", "7817", "7971", "6928", "6902", "2482", "3681", "3723", "7375", "3439", "6876", "7406", "4753", "7029", "6340", "6759", "2547", "4673", "7698", "2823", "4489", "7054", "6581", "7414", "6495", "6922", "6154", "7675", "7882", "2364", "2445", "7395", "7973", "4620", "7689", "6509", "6545", "6337", "3549", "7417", "2231", "6873", "6666", "4681", "2243", "3236", "7674", "6523", "2475", "3695", "3645", "4574", "6767", "2285", "4122", "7050", "3195", "7401", "7684", "7056", "6152", "6599", "5245", "2351", "6809", "6784", "3010", "7822", "2743", "4072", "2779", "2276", "3562", "3513", "2843", "2328", "3897", "2782", "4738", "2337", "7961", "6857", "3630", "6843", "4735", "3666", "4339", "7416", "7952", "6881", "3214", "2265", "3031", "7464", "3410", "3216", "7520", "3355", "7963", "4307", "4252", "2268", "6587", "6926", "3568", "2865", "6271", "6504", "3939", "4722", "6936", "2881", "7409", "7359", "4108", "2353", "4145", "7061", "3265", "6562", "7038", "7582", "4096", "4594", "3669", "7526", "7877", "6743", "3906", "7390", "7415", "6472", "4405", "2592", "3610", "3898", "6054", "7403", "6861", "7426", "6262", "5280", "3889", "7044", "2902", "6521", "6909", "7354", "6842", "6618", "2515", "4409", "2199", "7399", "7870", "2262", "4149", "4470", "4586", "7041", "7378", "7524", "6547", "6903", "6933", "3110", "2438", "2227", "7356", "6153", "7967", "4795", "2569", "5202", "2753", "7519", "2581", "2407", "2467", "7760", "6288", "7798", "7705", "2872", "7743", "3224", "7868", "4210", "4563", "4985", "2575", "3278", "3314", "4421", "4603", "2571", "4764", "6412", "7881", "7801", "2536", "7074", "6484", "7036", "3743", "6848", "7413", "7835", "7869", "6869", "5244", "7776", "7455", "7669", "7438", "4385", "3376", "2348", "7704", "6786", "2332", "7521", "3697", "7411", "6877", "6706", "6373", "7046", "3159", "6136", "7407", "4754", "4438", "7419", "4570", "6156", "4774", "7544", "2354", "3041", "4376", "4851", "4706", "3476", "7806", "4248", "4627", "6796", "4855", "7239", "3802", "7370", "6632", "7057", "2755", "7764", "2949", "7032", "7072", "6351", "7664", "7879", "2931", "7381", "2796", "6771", "2570", "3775", "4562", "2713", "3255", "2419", "2818", "2309", "3044", "7080", "4727", "5147", "3672", "4445", "3861", "2422", "3440", "6778", "4086", "6687", "3918", "6781", "4677", "5253", "3494", "3434", "7686", "7134", "2590", "7863", "7873", "7393", "6178", "4120", "6541", "6536", "2306", "7458", "3721", "4408", "4571", "3812", "4026", "6490", "2357", "7660", "6700", "4156", "4917", "6886", "4804", "3420", "2340", "3438", "7821", "6746", "4211", "3590", "7793", "7466", "7205", "2226", "7543", "4349", "5282", "7433", "7735", "4193", "5306", "3706", "2477", "2915", "5227", "4728", "7791", "7053", "7372", "6106", "6664", "7807", "7567", "6534", "6865", "2331", "4053", "3629", "7025", "7692", "5302", "6891", "6882", "6243", "2831", "6914", "4412", "7412", "3325", "3994", "3341", "4432", "4757", "7049", "4488", "6244", "6362", "6860", "3249", "7778", "5255", "7065", "2573", "7360", "7369", "4373", "6175", "6009", "4471", "7157", "7547", "4439", "3825", "2330", "2773", "4504", "4268", "7073", "6870", "6773", "4519", "2461", "3829", "4236", "7428", "4831", "3564", "4062", "6918", "2266", "4552", "5261", "4328", "2138", "7679", "2799", "6912", "2349", "7405", "3043", "4836", "4926", "8030", "8034", "8022", "8023", "8026", "8031", "8037", "8036", "8044", "8045", "8028", "8024", "8032", "8035", "8043", "8021", "8029", "8033", "8038", "8025", "7404", "7842", "2403", "6234", "4402", "6067", "7151", "6259", "6382", "7432", "7956", "6757", "7391", "7541", "2748", "7383", "6248", "5304", "3323", "7852", "2166", "7222", "7816", "7837", "6675", "7981", "4988", "7838", "4306", "7026", "3419", "7848", "2696", "4712", "7525", "7070", "7744", "7410", "7392", "7938", "2131", "4353", "2299", "7400", "6875", "6789", "6501", "3057", "7687", "7030", "7844", "4085", "3053", "2317", "7531", "4533", "6924", "7040", "6125", "6357", "6223", "7663", "4139", "2297", "4606", "5281", "3597", "6662", "6548", "6050", "7052", "6919", "4621", "2255", "6900", "4020", "6920", "6661", "6770", "7028", "6822", "7529", "3139", "6481", "4080", "4725", "2311", "7444", "2714", "2532", "7358", "6229", "4324", "4263", "7425", "6191", "2352", "4482", "6544", "6871", "3614", "7450", "6394", "6483", "6580", "7847", "7566", "7977", "2917", "2300", "2585", "2870", "7854", "6913", "3992", "7031", "6785", "7366", "7067", "7777", "4635", "4940", "7402", "3805", "7021", "3789", "7522", "6256", "2797", "3293", "6917", "4605", "2548", "7683", "3197", "4331", "7397", "7661", "2418", "7804", "7945", "3423", "4752", "4406", "7045", "7668", "3194", "5136", "7387", "3691", "7233", "7434", "7781", "4550", "7671", "7396", "4800", "7849", "6237", "6600", "7361", "2294", "4995", "6543", "6182", "4330", "2250", "4200", "2460", "4865", "4623", "4875", "7850", "3157", "3208", "7386", "2390", "3804", "5179", "3220", "6240", "7680", "4876", "7685", "6258", "7783", "4597", "2269", "7845", "4707", "2439", "3345", "2212", "6908", "6542", "3266", "4694", "7975", "6224", "7535", "7784", "2201", "7955", "4709", "3473", "7408", "7812", "7662", "7023", "7796", "7859", "6172", "4809", "7203", "2957", "4799", "7048", "6631", "7394", "4802", "7470", "7146", "7063", "4023", "3813", "7039", "4431", "2310", "3660", "3823", "4637", "4001", "6334", "4888", "7429", "7858", "6884", "7164", "7940", "7037", "2579", "7051", "7033", "7787", "4250", "7840", "6624", "4134", "4783", "7363", "4588", "3741", "2393", "3054", "3291", "3739", "2549", "3584", "6516", "3717", "4517", "6428", "2258", "4483", "4867", "6358", "3156", "3433", "4329", "4528", "6646", "6218", "7530", "3234", "3180", "6780", "7851", "2465", "7677", "4622", "7560", "6299", "7035", "6925", "2463", "4751", "7314", "7843", "4000", "6605", "2918", "4403", "3484", "5279", "6899", "3375", "3409", "3737", "7380", "7800", "7357", "7785", "7047", "6090", "4607", "7676", "7528", "7681", "2552", "7672", "3965", "2308", "6889", "4018", "7813", "6035", "7688", "4460", "2512", "7799", "4171", "7527", "7839", "7373", "7055", "4294", "4587", "7228", "7024", "4174", "3152", "4029", "5246", "6222", "2350", "7968", "6826", "6906", "4506", "7064", "4628", "6923", "2355", "6883", "7857", "4221", "6905", "7068", "7005", "7588", "2977", "5223", "7424", "7834", "5303", "4503", "7367", "3378", "4724", "6021", "2462", "3102", "7374", "4012", "4730", "6177", "2772", "7388", "7034", "2519", "4380", "6221", "6898", "7427", "7584", "2702", "2483", "4449", "7962", "6260", "7371", "7042", "3381", "3558", "4960", "6160", "7841", "7252", "7802", "3807", "6198", "4974", "2771", "7782", "3179", "7942", "6716", "7456", "6099", "4825", "7150", "2248", "6921", "4526", "2850", "7550", "6916", "7659", "2459", "5009", "7673", "2619", "6879", "7242", "6851", "2939", "6888", "2591", "7853", "7532", "7326", "7939", "4737", "7856", "4733", "2202", "4629", "4410", "6513", "3201", "7951", "5248", "7855", "7937", "3062", "6085", "7539", "6901", "3092", "7231", "4646", "4906", "7062", "7943", "2200", "7204", "4514", "7423", "3390", "6122", "3692", "6142", "2979", "2687", "7728", "2444", "2346", "6104", "4500", "3929", "7275", "4911", "6097", "2321", "2391", "2224", "6528", "3347", "4398", "7479", "7644", "6348", "4046", "2707", "6225", "2731", "3550", "4842", "3875", "2320", "4820", "3510", "6185", "2539", "4645", "7243", "3467", "4281", "6420", "7594", "2901", "3286", "6390", "7635", "3373", "2553", "7748", "6810", "7461", "3458", "4509", "2434", "2371", "7756", "6688", "6817", "2476", "6573", "2458", "6551", "6546", "4613", "2867", "6565", "4525", "4414", "6366", "6181", "6671", "4665", "2216", "4868", "7264", "6597", "3306", "3357", "4870", "2821", "2885", "3360", "4869", "6084", "4644", "2611", "4684", "2820", "7949", "4862", "7173", "4679", "2814", "6127", "4075", "6310", "2960", "2749", "2646", "3803", "4113", "6231", "3029", "6294", "2622", "4856", "2852", "2759", "6031", "2651", "3408", "6056", "2641", "6799", "2976", "2943", "3753", "4925", "6410", "3877", "2639", "3656", "7437", "4857", "3204", "2761", "3514", "2626", "6505", "4828", "2604", "4082", "2927", "2904", "6339", "2880", "3991", "6269", "4147", "6379", "5160", "6440", "3173", "2964", "5283", "5145", "6287", "2659", "2729", "4180", "2723", "3003", "7555", "3639", "4188", "6322", "4536", "3648", "3636", "6332", "6343", "7536", "4833", "2389", "7266", "2369", "2235", "3198", "3196", "3530", "7518", "4680", "3574", "2271", "6352", "6707", "7627", "2791", "2754", "6614", "6995", "2832", "2720", "6994", "7191", "5013", "6209", "4937", "6033", "4766", "7283", "6024", "4994", "2370", "7268", "7276", "6893",
            "4524", "7274", "4975", "6800", "4473", "6795", "6336", "7509", "7445",
            "7564", "2413", "4004", "7617", "4495", "3953", "7598", "5277", "4823",
            "6456", "6510", "6414", "4441", "6630", "6359", "7640", "6144", "6184",
            "6316", "7736", "6195", "3472", "6552", "6596", "4934", "7562", "4494",
            "3622", "4472", "7267", "7636", "6208", "6354", "3993", "7792", "6265",
            "6307", "4782", "3615", "7284", "7634", "6356", "7313", "6636", "2455",
            "6947", "6292", "3366", "6594", "6391", "6403", "6374", "6158", "6607",
            "6892", "6760", "2839", "6284", "7574", "4493", "4928", "2489", "6591",
            "6377", "2969", "6346", "4600", "4803", "3830", "3362", "3356", "6531",
            "4044", "3595", "4209", "3522", "6803", "2368", "2341", "6527", "2802", "5260",
            "4191", "3746", "6515", "2396", "2305", "3684", "4534", "6335", "3465", "7930",
            "4190", "6512", "3130", "4543", "6574", "3598", "3305", "4302", "4314", "2236",
            "6537", "6963", "7965", "4958", "6949", "7165", "3674", "3162", "3443", "3353",
            "2787", "3359", "2986", "2873", "2063", "6327", "6100", "6025", "2342", "3229",
            "3412", "2412", "2373", "3947", "5278", "2188", "6667", "6649", "4648", "6606",
            "6698", "2283", "4682", "7568", "2896", "7690", "7648", "2441", "4416", "7439",
            "7646", "7484", "6276", "4181", "2215", "2727", "6633", "7953", "5101", "7499",
            "6709", "2937", "6719", "6148", "2834", "7139", "3374", "2854", "6637", "6720",
            "6740", "3399", "6737", "3315", "6173", "6065", "3302", "4164", "2827", "3098",
            "7958", "6734", "6079", "6708", "6124", "2891", "3167", "7346", "3455", "6808",
            "4121", "2952", "2956", "6313", "6753", "6364", "4231", "3117", "7148", "2719",
            "7328", "7957", "6405", "7325", "6433", "3400", "7331", "6959", "2860", "7591",
            "7606", "7167", "6437", "3600", "7202", "4742", "3903", "7241", "4982", "3577",
            "6586", "3100", "6714", "6744", "6715", "6852", "7322", "6812", "6764", "4132",
            "7630", "4045", "4110", "6086", "7282", "7610", "3801", "3481", "4556", "7001",
            "7758", "4336", "2491", "7121", "7123", "4510", "3490", "4490", "7124", "4529",
            "4428", "3631", "6532", "4311", "4997", "6991", "4243", "3486", "4309", "6176",
            "4458", "3018", "3069", "3227", "7125", "6169", "6965", "7130", "6704", "7129",
            "7128", "6972", "7122", "7126", "6665", "2456", "4890", "6684", "4515", "2398",
            "7788", "2982", "3084", "2728", "2684", "6832", "3311", "6118", "6939", "7279",
            "3253", "6120", "4946", "6853", "4498", "6735", "6008", "6078", "6093", "7224",
            "5271", "7209", "7502", "3342", "3153", "7494", "4952", "6108", "6678", "6387",
            "6946", "2660", "2663", "4522", "7548", "2655", "2781", "2809", "7196", "7182",
            "2680", "3099", "7265", "2798", "4580", "7206", "2795", "2722", "2817", "7497",
            "6430", "4950", "6416", "6713", "7207", "6739", "2996", "3025", "3158", "3287",
            "3262", "2677", "7192", "2879", "3334", "3251", "3290", "3682", "7197", "6701",
            "6738", "6575", "7718", "6419", "3686", "3544", "3840", "3938", "6443", "4226",
            "4066", "6454", "7199", "3280", "4033", "6131", "6935", "6442", "4560", "4969",
            "7178", "4912", "7190", "4984", "6910", "6415", "3101", "6074", "6940", "6726",
            "6978", "6103", "6434", "6934", "3637", "3575", "3235", "4516", "4480", "4484",
            "7507", "4945", "3254", "4549", "4319", "4462", "7508", "4559", "4813", "4878",
            "4789", "4880", "4829", "4964", "4881", "4889", "4954", "4203", "4996", "4999",
            "7500", "4461", "6286", "6938", "6854", "6149", "6324", "6654", "6077", "6326",
            "6283", "7465", "6741", "2813", "7475", "7210", "3936", "6245", "4953", "6230",
            "7186", "7515", "7435", "7294", "7251", "7498", "7493", "6389", "6685", "6805",
            "7335", "7143", "7261", "6395", "7183", "7621", "6584", "4879", "7258", "7628", "7517", "6724", "7586", "6697", "6752", "4537", "7269", "7223", "7208", "7218", "7166", "6725", "7172", "7175", "7187", "6363", "7185", "7212", "7220", "7215", "6937", "7198", "3086", "6855", "7194", "7193", "3624", "7766", "7960", "7944", "7449", "7563", "3321", "3545", "3551", "5276", "7496", "7249", "4208", "7763", "7653", "3469", "2650", "7300", "7278", "6367", "7808", "3046", "6137", "4747", "6976", "6468", "6962", "6973", "7577", "7645", "6159", "7572", "3687", "6623", "3441", "6431", "4772", "2747", "3961", "4253", "4382", "4895", "6371", "4685", "6974", "6344", "3714", "3237", "2209", "7579", "3811", "7353", "2697", "3452", "2671", "4933", "4592", "4251", "6520", "6955", "7503", "6564", "4894", "6406", "6732", "7481", "3495", "4990", "7421", "3370", "6070", "7504", "4446", "2974", "4129", "4003", "3762", "6068", "6001", "7514", "3882", "7609", "7616", "3005", "7824", "4779", "2841", "3923", "6385", "6971", "6975", "4074", "7954", "6819", "2558", "4914", "3295", "7571", "6611", "7216", "6956", "4332", "4434", "3190", "6507", "2230", "4161", "4256", "3318", "3536", "4647", "3716", "6238", "3620", "2177", "6109", "2973", "2644", "2935", "2926", "4039", "2883", "2967", "4900", "2970", "3899", "4186", "4539", "4212", "6874", "4540", "3841", "4015", "3886", "4703", "2971", "6602", "3579", "2889", "3904", "2767", "2745", "4718", "4695", "7347", "4512", "4417", "7501", "6836", "4538", "8129", "6835", "6570", "2158", "4626", "4341", "2589", "7227", "4443", "8130", "7637", "5208", "6128", "7969", "7987", "7974", "8146", "8142", "7980", "7471", "8019", "7994", "8020", "8046", "7978", "3917", "6712", "8131", "8006", "8154", "7742", "8027", "8150", "8120", "8148", "8143", "8239", "7966", "8104", "8108", "8128", "8080", "8086", "8139", "8251", "8138", "8124", "8079", "8100", "8125", "8087", "8013", "8081", "7985", "7982", "8082", "8083", "8084", "8085", "8088", "8089", "8090", "8091", "8092", "8093", "8094", "8095", "8096", "8097", "8098", "8099", "8101", "8102", "8103", "8105", "8106", "8107", "8109", "8110", "8111", "8112", "8113", "8114", "8115", "8116", "8117", "8118", "8119", "8123", "8126", "8127", "8135", "8136", "8137", "8140", "8147", "8149", "8151", "8155", "8156", "8157", "8158", "8159", "8160", "8161", "8162", "8164", "8165", "8166", "8167", "8169", "8170", "8171", "8176", "8177", "8178", "8180", "8181", "8182", "8183", "8184", "8196", "8199", "8202", "8203", "8204", "8205", "8206", "8207", "8208", "8209", "8210", "8211", "8212", "8213", "8214", "8215", "8216", "8217", "8218", "8219", "8220", "8221", "8222", "8223", "8224", "8225", "8226", "8227", "8228", "8229", "8230", "8231", "8232", "8233", "8234", "8235", "8236", "8237", "8240", "8241", "8242", "8243", "8244", "8245", "8246", "8247", "8248", "8249", "8250", "8252", "8253", "8254", "8255", "8256", "8257", "8258", "8259", "8260", "8261", "8262", "8263", "8264", "8265", "8266", "8267", "8268", "8269", "8270", "8271", "8272", "8273", "8274", "8275", "8276", "8277", "8278", "8279", "8280", "8281", "8282", "8283", "8284", "8285", "8286", "8287", "8288", "8289", "8290", "8291", "8292", "8293", "8294", "8295", "8296", "8297", "8298", "8299", "8300", "8301", "8303", "8304", "8305", "8306", "8307", "8308", "8309", "8310", "8311", "8312", "8313", "8316", "8302", "7972", "8132", "8133", "8008", "8010", "8321", "7011", "8320", "8323", "8324", "3415", "6315", "6278", "7790", "6692", "8152", "6827", "6253", "7014", "6044", "4608", "4641", "7118", "7007", "7075", "4651", "7002", "4363", "2566", "4642", "7750", "7749", "4036", "3221", "6027", "3998", "6790", "3707", "4860", "4051", "4379", "4364", "7084", "3734", "2511", "3223", "4904", "3207", "4657", "2327", "6500", "2685", "3331", "4034", "6169", "4890", "8048", "8328", "7805", "7993", "2411", "4335", "3502", "4639", "3330", "4840", "7016", "7015", "3670", "6997", "2472", "3776", "2496"]
